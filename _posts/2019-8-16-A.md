---
layout: post
title: Hello World!
tags: Hydrogen
stickie: true
---

[题目链接](https://www.lydsy.com/JudgeOnline/problem.php?id=4176)

------------
f(n)表示n的因子个数

$f(ij)=\sum_{x|i}\sum_{y|j}[gcd(i,j)==1]$

原式整理得：

$\sum_{t=1}\mu(t)(\sum_{i=1}^{n/t} \left \lfloor \frac{n}{it}\right \rfloor)^{2}$

杜教筛处理前缀和

------------
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long int lli;
const int mod=1e9+7;
const int M=1e7+10;
int prime[M],tot,vis[M],mu[M];
map<int,int>smu;
void init()
{
    mu[1]=1;
    for(int i=2;i<=M;i++)
    {
        if(!vis[i])
        {
            prime[++tot]=i;
            mu[i]=-1;
        }
        for(int j=1;j<=tot&&i*prime[j]<=M;j++)
        {
            vis[i*prime[j]]=1;
            if(i%prime[j]==0)break;
            else mu[i*prime[j]]=-mu[i];
        }
    }
    for(int i=2;i<=M;i++)mu[i]+=mu[i-1];
}
lli get(lli x){
    if(x<=M)return mu[x];
    if(smu[x])return smu[x];
    lli ret=1;
    for(lli l=2,r=0;r!=x;l=r+1){
        r=x/(x/l);
        ret-=1ll*(r-l+1)*get(x/l);
    }
    return smu[x]=ret;
}
lli cal(lli n)
{
    lli res=0;
    for(lli l=1,r=0;l<=n;l=r+1)
    {
        r=n/(n/l);
        res=(res+(r-l+1)*(n/l)%mod)%mod;
    }
    return res*res%mod;
}
int main(int argc, char const *argv[])
{
    init();
    lli n,ans=0;scanf("%lld",&n);
    for(lli l=1,r=0;l<=n;l=r+1)
    {
        r=n/(n/l);
        ans=(ans+(get(r)-get(l-1)+mod)%mod*cal(n/l)%mod)%mod;
    }
    printf("%lld\n",ans);
    return 0;
}
```
